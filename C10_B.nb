(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     75067,       1661]
NotebookOptionsPosition[     70490,       1553]
NotebookOutlinePosition[     70826,       1568]
CellTagsIndexPosition[     70783,       1565]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.71320295092316*^9, 
  3.713202953819333*^9}},ExpressionUUID->"ddd288e6-9892-41da-9e47-\
6724a2c0f569"],

Cell["\<\
First download the CCAT_10 corpus to home directory. From there the code is \
as below.\
\>", "Text",
 CellChangeTimes->{{3.719339086989756*^9, 
  3.719339116621324*^9}},ExpressionUUID->"30840753-515a-49bf-a11b-\
4bf6378713d9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"c10Train", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "$HomeDirectory", ",", "\"\<c10\>\"", ",", "\"\<C10train\>\"", ",", 
       "\"\<*\>\""}], "}"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"c10Test", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "$HomeDirectory", ",", "\"\<c10\>\"", ",", "\"\<C10test\>\"", ",", 
       "\"\<*\>\""}], "}"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"allC10TrainFiles", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "$HomeDirectory", ",", "\"\<c10\>\"", ",", "\"\<C10train\>\"", ",", 
       "\"\<*\>\"", ",", "\"\<*\>\""}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allC10TestFiles", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "$HomeDirectory", ",", "\"\<c10\>\"", ",", "\"\<C10test\>\"", ",", 
       "\"\<*\>\"", ",", "\"\<*\>\""}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"allTrainWritings", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"#", ",", "\"\<Text\>\""}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"50", ",", 
           RowBox[{"-", "50"}]}], "}"}]}], "]"}], "&"}], ",", 
      "allC10TrainFiles"}], "]"}]}], ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"allTestWritings", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"#", ",", "\"\<Text\>\""}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"50", ",", 
           RowBox[{"-", "50"}]}], "}"}]}], "]"}], "&"}], ",", 
      "allC10TestFiles"}], "]"}]}], ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allTrainWritingsPartitioned", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{"allTrainWritings", ",", "50"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allTestWritingsPartitioned", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{"allTestWritings", ",", "50"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MaxMemoryUsed", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.713035642949237*^9, 3.713035717039057*^9}, 
   3.713036887562438*^9, 3.7131023509802437`*^9, {3.71310349468113*^9, 
   3.713103501528813*^9}, {3.713184021235046*^9, 3.713184086095158*^9}, {
   3.717876091650577*^9, 
   3.717876136563189*^9}},ExpressionUUID->"032f0415-c721-4535-b2f5-\
0baf381a9383"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.317988`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.717876108709444*^9, 3.717876146066104*^9, 
  3.717957290279982*^9, 
  3.717964653809915*^9},ExpressionUUID->"414d7e84-ac03-4995-97f5-\
20a51b49aeca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.306647`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.717876108709444*^9, 3.717876146066104*^9, 
  3.717957290279982*^9, 
  3.717964655107149*^9},ExpressionUUID->"18628712-a963-4533-a463-\
890e4839a8b0"],

Cell[BoxData["74511336"], "Output",
 CellChangeTimes->{3.717876108709444*^9, 3.717876146066104*^9, 
  3.717957290279982*^9, 
  3.717964655107791*^9},ExpressionUUID->"f18eed69-0c43-4dd3-b371-\
32d911ab3b64"]
}, Open  ]],

Cell["\<\
letterRules1 = {\"d\" | \"p\" -> \"b\", \"k\" | \"q\" | \"x\" | \"z\" -> \
\"c\", \"f\" -> \"s\", 
    \"h\" | \"j\" -> \"g\", \"n\" -> \"m\", \"y\" | \"i\" | \"v\" | \"w\" -> \
\"u\", 
    \"?\" | \"!\" | \":\" -> \".\", \";\" | \",\" -> \" \", \"(\" | \")\" | \
\"-\" | \"+\" | \"[\" | \"]\" -> 
     \"(\", \"\\t\" | \"\\n\" -> \" \", \"1\" | \"2\" | \"3\" | \"4\" | \"5\" \
| \"6\" | \"7\" | \"8\" | \"9\" -> 
     \"0\"}; 
letterRules2 = Thread[{\"a\", \"e\", \"o\", \"u\", \"b\", \"c\", \"g\", \
\"l\", \"m\", \"r\", \"s\", \"t\", 
      \".\", \"(\", \" \", \"0\"} -> IntegerDigits[Range[0, 15], 4, 2]]; \
\>", "Input",
 CellChangeTimes->{{3.691434904616869*^9, 3.6914349164123087`*^9}, 
   3.691434993613287*^9, 3.691435079182316*^9, {3.691435221641609*^9, 
   3.691435289778919*^9}, {3.691435364305429*^9, 3.691435396011238*^9}, {
   3.6914354326747293`*^9, 3.6914354439533653`*^9}, {3.691435818346161*^9, 
   3.6914358798816767`*^9}, {3.691931079097324*^9, 3.691931081202388*^9}, {
   3.693252187133408*^9, 3.693252218534032*^9}, {3.6932522495937767`*^9, 
   3.69325227351204*^9}, {3.693252745712919*^9, 3.69325279787542*^9}, 
   3.6932531809294662`*^9, 3.704219286899498*^9, {3.713113922674527*^9, 
   3.7131139359553757`*^9}, 3.713200826411829*^9, 
   3.713200935113042*^9},ExpressionUUID->"4a804f6d-7397-4a73-a645-\
201245f67000"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"traintextLetters", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Characters", "[", 
        RowBox[{"ToLowerCase", "[", 
         RowBox[{"RemoveDiacritics", "[", "#", "]"}], "]"}], "]"}], "&"}], 
      ",", "allTrainWritingsPartitioned", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{
    RowBox[{"traindigitseqs", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Developer`ToPackedArray", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"IntegerDigits", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"#", "/.", "letterRules1"}], "/.", "letterRules2"}], 
              "]"}], ",", "2", ",", "2"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"IntegerDigits", "[", "__", "]"}], "\[RuleDelayed]", 
            "Nothing"}]}], ")"}], "]"}], "&"}], ",", "traintextLetters", ",", 
       
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "]"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"testtextLetters", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Characters", "[", 
        RowBox[{"ToLowerCase", "[", 
         RowBox[{"RemoveDiacritics", "[", "#", "]"}], "]"}], "]"}], "&"}], 
      ",", "allTestWritingsPartitioned", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{
    RowBox[{"testdigitseqs", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Developer`ToPackedArray", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"IntegerDigits", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"#", "/.", "letterRules1"}], "/.", "letterRules2"}], 
              "]"}], ",", "2", ",", "2"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"IntegerDigits", "[", "__", "]"}], "\[RuleDelayed]", 
            "Nothing"}]}], ")"}], "]"}], "&"}], ",", "testtextLetters", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "]"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trainauthors", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"FileNameTake", ",", "c10Train"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ltlen", "=", 
   RowBox[{"Length", "[", "trainauthors", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"testauthors", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"FileNameTake", ",", "c10Test"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MaxMemoryUsed", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.704219250901642*^9, 3.704219269317607*^9}, {
   3.704219309857554*^9, 3.7042193579455557`*^9}, {3.704219389938637*^9, 
   3.704219412018808*^9}, {3.704446948513287*^9, 3.704446956537767*^9}, 
   3.704452416296283*^9, {3.704452545416479*^9, 3.704452563672875*^9}, {
   3.704452670475052*^9, 3.704452692603199*^9}, {3.7044529157269583`*^9, 
   3.704452925069306*^9}, 3.704455557367475*^9, {3.7044653092482023`*^9, 
   3.7044653136433487`*^9}, 3.713036262126857*^9, {3.713036322863351*^9, 
   3.713036329468788*^9}, {3.713036974857283*^9, 3.713036993364101*^9}, {
   3.713102413370729*^9, 3.713102428649263*^9}, 3.713102710542725*^9, {
   3.713102860145205*^9, 3.713102872736018*^9}, {3.713184136388095*^9, 
   3.713184138590434*^9}, {3.717876167584022*^9, 
   3.717876180979951*^9}},ExpressionUUID->"cd631152-a356-4c3a-b75c-\
06212ee5527d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.213011`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.713184222929123*^9, 3.717876196622405*^9, 
  3.7179572936957808`*^9, 
  3.7179646565043793`*^9},ExpressionUUID->"db4378ae-69a2-418a-847a-\
0763ed072d73"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.663524`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.713184222929123*^9, 3.717876196622405*^9, 
  3.7179572936957808`*^9, 
  3.717964660168119*^9},ExpressionUUID->"2006a88a-a8ab-4b17-9542-\
1e146c2334e4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.19793`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.713184222929123*^9, 3.717876196622405*^9, 
  3.7179572936957808`*^9, 
  3.7179646603778954`*^9},ExpressionUUID->"bde0d474-6b69-4a6f-b086-\
1ddd7995ba13"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.656327`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.713184222929123*^9, 3.717876196622405*^9, 
  3.7179572936957808`*^9, 
  3.717964664066864*^9},ExpressionUUID->"13fcef02-a303-4a79-bfb6-\
05ebbdc740ff"],

Cell[BoxData["365410840"], "Output",
 CellChangeTimes->{3.713184222929123*^9, 3.717876196622405*^9, 
  3.7179572936957808`*^9, 
  3.717964664067513*^9},ExpressionUUID->"22383a76-6c3e-4976-bc9c-\
07e04f0f58b9"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"makePositionsC", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"shifts", ",", "_Integer", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "_Integer"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "posns", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"posns", "=", 
          RowBox[{"FoldList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"2", "*", "#1"}], "+", "#2"}], ",", 
               RowBox[{"2", "^", "k"}]}], "]"}], "&"}], ",", 
            RowBox[{"Reverse", "@", "shifts"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Most", "[", 
          RowBox[{"Reverse", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"2", "^", "k"}], ",", "1"}], "}"}], "+", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
                RowBox[{"Reverse", "[", "#", "]"}]}]}], "&"}], ",", "posns"}],
             "]"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FCGR", "[", 
   RowBox[{"chars_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"posns", ",", "newposns"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newposns", "=", 
      RowBox[{"Round", "[", 
       RowBox[{"makePositionsC", "[", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"chars", ",", 
           RowBox[{"{", 
            RowBox[{"_Integer", ",", "_Integer"}], "}"}]}], "]"}], ",", "k"}],
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Normal", "[", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"Tally", "[", "newposns", "]"}], ",", 
          RowBox[{"{", "1", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", "^", "k"}], ",", 
          RowBox[{"2", "^", "k"}]}], "}"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",ExpressionUUID->"6133bfe3-8339-\
42c5-b7eb-b3024c27b799"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pixLevel", "=", "7"}], ";"}], "\n", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"trainimages1a", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"FCGR", "[", 
       RowBox[{
        RowBox[{"traindigitseqs", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", "pixLevel"}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "ltlen"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"traindigitseqs", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"testimages1a", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"FCGR", "[", 
       RowBox[{
        RowBox[{"testdigitseqs", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", "pixLevel"}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "ltlen"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"testdigitseqs", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MaxMemoryUsed", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.687528038670236*^9, 3.687528063550949*^9}, {
   3.687528103114566*^9, 3.687528114160242*^9}, {3.687528380471059*^9, 
   3.687528409732607*^9}, {3.6875284977696867`*^9, 3.687528551880024*^9}, {
   3.687529956317741*^9, 3.687530031451489*^9}, {3.6875300650510406`*^9, 
   3.6875301041407967`*^9}, {3.6875439271604033`*^9, 3.687543937394638*^9}, {
   3.6875439837853813`*^9, 3.687544049222252*^9}, {3.687544140362761*^9, 
   3.6875441630176973`*^9}, 3.687544909476797*^9, {3.6875449853018847`*^9, 
   3.687545183385084*^9}, {3.6875452189009733`*^9, 3.687545223112357*^9}, {
   3.687545262587791*^9, 3.687545308364909*^9}, {3.687546196006886*^9, 
   3.68754622578083*^9}, {3.687546431785445*^9, 3.687546607967441*^9}, 
   3.687546728989406*^9, {3.687546977698173*^9, 3.687547032534132*^9}, {
   3.688242217510295*^9, 3.688242226722733*^9}, 3.688242354908801*^9, 
   3.688242634681233*^9, 3.688242897118081*^9, 3.688242962111631*^9, {
   3.6914226482468*^9, 3.691422661009863*^9}, {3.691423306572405*^9, 
   3.6914233095351543`*^9}, {3.691424044536046*^9, 3.691424060534472*^9}, 
   3.69142416554678*^9, {3.6914242256922483`*^9, 3.6914242529885263`*^9}, {
   3.691424892532922*^9, 3.691424894911277*^9}, {3.691424936565754*^9, 
   3.691424957681055*^9}, {3.6914250125034723`*^9, 3.691425014035327*^9}, 
   3.691436459633583*^9, 3.691436572382522*^9, 3.691436653186837*^9, {
   3.6914366946910763`*^9, 3.691436723411421*^9}, 3.691437334521577*^9, {
   3.691498736779779*^9, 3.691498741018301*^9}, 3.691499732438778*^9, 
   3.691499912396071*^9, 3.6914999564423723`*^9, {3.691500006476392*^9, 
   3.691500016301544*^9}, 3.691500081710161*^9, 3.691500131054908*^9, 
   3.691500176110051*^9, 3.691500240944745*^9, 3.691500321999906*^9, 
   3.691500391765172*^9, 3.691500511379923*^9, 3.691500668582239*^9, 
   3.691500776743396*^9, 3.691500838888278*^9, 3.69150112415644*^9, {
   3.6915011669728928`*^9, 3.69150117095331*^9}, 3.6915012072268744`*^9, {
   3.691501246670703*^9, 3.691501278602927*^9}, {3.691502035320671*^9, 
   3.691502038438024*^9}, {3.6915021018978033`*^9, 3.691502104182685*^9}, 
   3.691503212297433*^9, 3.691503271785595*^9, 3.691930830642803*^9, 
   3.6919311647294807`*^9, 3.692448663375454*^9, {3.69324590334592*^9, 
   3.693245917650547*^9}, {3.6932460441486187`*^9, 3.6932460464364977`*^9}, 
   3.693246805553916*^9, 3.693246920050556*^9, 3.6932471021333323`*^9, 
   3.693247160197043*^9, 3.69324723195954*^9, {3.693247311607706*^9, 
   3.6932473267442703`*^9}, 3.6932523471643953`*^9, {3.693252845499206*^9, 
   3.693252854978941*^9}, {3.693253210480472*^9, 3.693253263860474*^9}, {
   3.6932533272411547`*^9, 3.693253335192955*^9}, 3.693265917375807*^9, {
   3.693266267843457*^9, 3.6932662701396437`*^9}, 3.693266650721377*^9, 
   3.6932667643301897`*^9, 3.6932668654353323`*^9, {3.693267013690983*^9, 
   3.693267019497507*^9}, {3.704219908266467*^9, 3.704219991165193*^9}, 
   3.7042200322531357`*^9, 3.704220066013527*^9, 3.704221403586219*^9, 
   3.704221527843789*^9, 3.704221613045409*^9, 3.7042217081980867`*^9, {
   3.7042217462314568`*^9, 3.704221751958297*^9}, 3.704221845817569*^9, 
   3.704447113346766*^9, 3.704447155540543*^9, {3.704447269906636*^9, 
   3.704447276354638*^9}, {3.7044476121373777`*^9, 3.7044476229484987`*^9}, {
   3.704447686021411*^9, 3.704447698884672*^9}, 3.704447788413445*^9, {
   3.704447843289304*^9, 3.704447863742022*^9}, 3.704447919640428*^9, {
   3.7044556304381533`*^9, 3.7044556368650723`*^9}, 3.704457560222374*^9, {
   3.704457921308158*^9, 3.704457927373766*^9}, {3.704457993289102*^9, 
   3.704457998804351*^9}, {3.704458051452138*^9, 3.704458065012898*^9}, 
   3.704458134538164*^9, {3.7044581956701717`*^9, 3.70445826731971*^9}, 
   3.704458481081585*^9, {3.704458617678548*^9, 3.704458648713272*^9}, {
   3.704459374862018*^9, 3.704459378722466*^9}, 3.704463204128619*^9, 
   3.7044632690898447`*^9, {3.704463483211426*^9, 3.704463486682506*^9}, {
   3.7044635436613827`*^9, 3.704463573428546*^9}, 3.704463650462819*^9, {
   3.7044639860860357`*^9, 3.704464002862258*^9}, {3.704464044662475*^9, 
   3.7044640524522142`*^9}, 3.704464103623014*^9, {3.704464314696044*^9, 
   3.7044643351865187`*^9}, 3.7044650536611423`*^9, 3.70446533803769*^9, 
   3.704467052193458*^9, 3.704467276317543*^9, {3.713037121419916*^9, 
   3.713037156919015*^9}, 3.7130930620965767`*^9, 3.71309349066835*^9, {
   3.713096712399732*^9, 3.713096715550839*^9}, {3.7130971314942408`*^9, 
   3.7130971330598183`*^9}, {3.713113987629696*^9, 3.713113994306326*^9}, 
   3.713114039277752*^9, 3.7131145874511337`*^9, 3.713116765475799*^9, {
   3.713116880683803*^9, 3.7131168831767693`*^9}, 3.713117289771174*^9, 
   3.71311734801647*^9, 3.7131177027681637`*^9, 3.717876475611499*^9, 
   3.7178765240052567`*^9, {3.7179447492711*^9, 3.7179447550569153`*^9}, 
   3.717944918345173*^9, 
   3.717945219453784*^9},ExpressionUUID->"5275d71f-79dc-4281-a554-\
6d4f32dc4614"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.752443`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.713184239032033*^9, 3.717876229080358*^9, 
  3.717876478753793*^9, 3.717876527363505*^9, 3.717941232365089*^9, 
  3.717944921729372*^9, 3.717945223040954*^9, 3.7179573074832973`*^9, 
  3.7179581412725563`*^9, 
  3.717964667239852*^9},ExpressionUUID->"1ed6c1db-fe45-4533-a2b6-\
698daf2498ae"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.749203`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.713184239032033*^9, 3.717876229080358*^9, 
  3.717876478753793*^9, 3.717876527363505*^9, 3.717941232365089*^9, 
  3.717944921729372*^9, 3.717945223040954*^9, 3.7179573074832973`*^9, 
  3.7179581412725563`*^9, 
  3.717964669989543*^9},ExpressionUUID->"ee683e4e-4613-41e2-82e7-\
0be57ac8cfd1"],

Cell[BoxData["499620624"], "Output",
 CellChangeTimes->{3.713184239032033*^9, 3.717876229080358*^9, 
  3.717876478753793*^9, 3.717876527363505*^9, 3.717941232365089*^9, 
  3.717944921729372*^9, 3.717945223040954*^9, 3.7179573074832973`*^9, 
  3.7179581412725563`*^9, 
  3.717964669990641*^9},ExpressionUUID->"1acf7ab1-c07d-4813-a77e-\
ade8faa69138"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"expon", "=", 
   RowBox[{"1", "/", "10"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"trainimages1", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "/", 
         RowBox[{"N", "[", 
          RowBox[{"Max", "[", "#", "]"}], "]"}]}], ")"}], "^", "expon"}], 
      "&"}], ",", "trainimages1a", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"testimages1", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "/", 
         RowBox[{"N", "[", 
          RowBox[{"Max", "[", "#", "]"}], "]"}]}], ")"}], "^", "expon"}], 
      "&"}], ",", "testimages1a", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"MaxMemoryUsed", "[", "]"}], "\n", 
 RowBox[{
  RowBox[{"trainSetLabels", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"trainauthors", "[", 
         RowBox[{"[", "j", "]"}], "]"}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"trainimages1", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "ltlen"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trainImages", "=", 
   RowBox[{"Apply", "[", 
    RowBox[{"Join", ",", "trainimages1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testSetLabels", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"testauthors", "[", 
         RowBox[{"[", "j", "]"}], "]"}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"testimages1", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "ltlen"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testImages", "=", 
   RowBox[{"Apply", "[", 
    RowBox[{"Join", ",", "testimages1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "testImages", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MaxMemoryUsed", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.7044583407163353`*^9, 3.704458351387487*^9}, {
   3.70445844238201*^9, 3.704458460460647*^9}, {3.7044586254705563`*^9, 
   3.704458629934235*^9}, 3.704458665618669*^9, 3.704463755546508*^9, {
   3.704463792353013*^9, 3.70446379362782*^9}, 3.704463827147468*^9, 
   3.704463857808714*^9, 3.70446389241821*^9, {3.704465081133258*^9, 
   3.7044651043649673`*^9}, {3.7130371785114527`*^9, 3.713037200035894*^9}, {
   3.713116872793943*^9, 3.713116889332671*^9}, {3.713117017462887*^9, 
   3.713117073691524*^9}, {3.713118181671173*^9, 3.713118190811018*^9}, {
   3.713118589633379*^9, 3.713118591709794*^9}, {3.713119029113428*^9, 
   3.713119036692204*^9}, 3.7131193205102882`*^9, {3.713119576202414*^9, 
   3.7131195770543327`*^9}, {3.7131199670930643`*^9, 3.713119967667859*^9}, {
   3.7131200453170767`*^9, 3.713120051684885*^9}, 3.713120369899661*^9, {
   3.7131215111629057`*^9, 3.713121514521365*^9}, 3.713121718586648*^9, {
   3.713122196853445*^9, 3.713122197459004*^9}, {3.713184381529372*^9, 
   3.71318438329845*^9}, {3.7131844258818398`*^9, 3.7131844262111187`*^9}, {
   3.7131875741975594`*^9, 3.71318757656279*^9}, 3.713187807494422*^9, 
   3.7131878615437593`*^9, {3.71318818500031*^9, 3.713188192971971*^9}, 
   3.7131882286316757`*^9, {3.7131883257914963`*^9, 3.713188327886629*^9}, {
   3.7131884265419893`*^9, 3.713188427929824*^9}, {3.713188577362978*^9, 
   3.713188578864553*^9}, {3.713188686062191*^9, 3.713188687565734*^9}, 
   3.713201019403166*^9, 3.717876254992117*^9, {3.7178762970575113`*^9, 
   3.717876304373372*^9}, {3.717876447083028*^9, 3.717876469787236*^9}, 
   3.7179346660624313`*^9, {3.717941226774535*^9, 3.717941276192938*^9}, 
   3.717946029154063*^9, {3.718061438817627*^9, 
   3.718061439594865*^9}},ExpressionUUID->"e5b54312-a5c4-4d06-882c-\
36f4bd1c47b3"],

Cell[BoxData["2724617144"], "Output",
 CellChangeTimes->{
  3.713184244995665*^9, 3.713184386017305*^9, 3.713184428506858*^9, {
   3.713187579824827*^9, 3.713187603862153*^9}, {3.713187788308662*^9, 
   3.713187810731637*^9}, 3.7131878647655354`*^9, 3.713187970725247*^9, 
   3.713188141086851*^9, {3.713188181840241*^9, 3.713188195025895*^9}, 
   3.713188231964921*^9, 3.713188330613556*^9, 3.713188432603898*^9, 
   3.713188582563128*^9, 3.713188690531207*^9, 3.713188727406766*^9, 
   3.71318876191752*^9, 3.717876260463622*^9, 3.717876305318644*^9, {
   3.7178764483202457`*^9, 3.717876481458097*^9}, 3.717876531875717*^9, 
   3.7179346682190332`*^9, {3.717941239821837*^9, 3.717941277407495*^9}, 
   3.717944926464691*^9, 3.71794522645673*^9, 3.717946030354484*^9, 
   3.7179573137286577`*^9, 3.717958144463867*^9, 3.71796467058162*^9, {
   3.718061476489172*^9, 3.718061481334587*^9}, 
   3.718061612841457*^9},ExpressionUUID->"ae96dd4b-abbc-45fb-b513-\
5d0260ed3cff"],

Cell[BoxData["500"], "Output",
 CellChangeTimes->{
  3.713184244995665*^9, 3.713184386017305*^9, 3.713184428506858*^9, {
   3.713187579824827*^9, 3.713187603862153*^9}, {3.713187788308662*^9, 
   3.713187810731637*^9}, 3.7131878647655354`*^9, 3.713187970725247*^9, 
   3.713188141086851*^9, {3.713188181840241*^9, 3.713188195025895*^9}, 
   3.713188231964921*^9, 3.713188330613556*^9, 3.713188432603898*^9, 
   3.713188582563128*^9, 3.713188690531207*^9, 3.713188727406766*^9, 
   3.71318876191752*^9, 3.717876260463622*^9, 3.717876305318644*^9, {
   3.7178764483202457`*^9, 3.717876481458097*^9}, 3.717876531875717*^9, 
   3.7179346682190332`*^9, {3.717941239821837*^9, 3.717941277407495*^9}, 
   3.717944926464691*^9, 3.71794522645673*^9, 3.717946030354484*^9, 
   3.7179573137286577`*^9, 3.717958144463867*^9, 3.71796467058162*^9, {
   3.718061476489172*^9, 3.718061481334587*^9}, 
   3.71806161284247*^9},ExpressionUUID->"3dba4f8f-e3b7-4699-ac78-\
8b9bc39be108"],

Cell[BoxData["2724617144"], "Output",
 CellChangeTimes->{
  3.713184244995665*^9, 3.713184386017305*^9, 3.713184428506858*^9, {
   3.713187579824827*^9, 3.713187603862153*^9}, {3.713187788308662*^9, 
   3.713187810731637*^9}, 3.7131878647655354`*^9, 3.713187970725247*^9, 
   3.713188141086851*^9, {3.713188181840241*^9, 3.713188195025895*^9}, 
   3.713188231964921*^9, 3.713188330613556*^9, 3.713188432603898*^9, 
   3.713188582563128*^9, 3.713188690531207*^9, 3.713188727406766*^9, 
   3.71318876191752*^9, 3.717876260463622*^9, 3.717876305318644*^9, {
   3.7178764483202457`*^9, 3.717876481458097*^9}, 3.717876531875717*^9, 
   3.7179346682190332`*^9, {3.717941239821837*^9, 3.717941277407495*^9}, 
   3.717944926464691*^9, 3.71794522645673*^9, 3.717946030354484*^9, 
   3.7179573137286577`*^9, 3.717958144463867*^9, 3.71796467058162*^9, {
   3.718061476489172*^9, 3.718061481334587*^9}, 
   3.718061612843171*^9},ExpressionUUID->"08f500ab-5b87-4b33-964c-\
567fa165b68b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nearestImages", "[", 
    RowBox[{"ilist_", ",", "vals_", ",", "dn_", ",", "dnum_", ",", "keep_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"idata", "=", "ilist"}], ",", "dcts", ",", "top", ",", 
       "\[IndentingNewLine]", "topvecs", ",", "uu", ",", "ww", ",", "vv", ",",
        "udotw", ",", "norms"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dcts", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FourierDST", "[", 
           RowBox[{
            RowBox[{"#", "-", 
             RowBox[{"Mean", "[", 
              RowBox[{"Flatten", "[", "#", "]"}], "]"}]}], ",", "dnum"}], 
           "]"}], "&"}], ",", "idata"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"top", "=", 
       RowBox[{"dcts", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"1", ";;", 
           RowBox[{"dn", "+", "1"}]}], ",", 
          RowBox[{"1", ";;", 
           RowBox[{"dn", "+", "1"}]}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"topvecs", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"Flatten", ",", "top"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"{", 
        RowBox[{"uu", ",", "ww", ",", "vv"}], "}"}], "=", 
       "\[IndentingNewLine]", 
       RowBox[{"SingularValueDecomposition", "[", 
        RowBox[{"topvecs", ",", "keep"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"udotw", "=", 
       RowBox[{"uu", ".", "ww"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"norms", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"#", ".", "#"}], "]"}], "&"}], ",", "udotw"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"udotw", "=", 
       RowBox[{"udotw", "/", "norms"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Nearest", "[", 
         RowBox[{
          RowBox[{"udotw", "\[Rule]", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"udotw", ",", "vals"}], "}"}], "]"}]}], ",", 
          RowBox[{"Method", "\[Rule]", "\"\<KDTree\>\""}]}], "]"}], ",", 
        "vv"}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"processInput", "[", 
   RowBox[{"ilist_", ",", "vv_", ",", "dn_", ",", "dnum_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"idata", "=", "ilist"}], ",", "dcts", ",", "top", ",", 
      "\[IndentingNewLine]", "topvecs", ",", "tdotv", ",", "norms"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dcts", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FourierDST", "[", 
          RowBox[{
           RowBox[{"#", "-", 
            RowBox[{"Mean", "[", 
             RowBox[{"Flatten", "[", "#", "]"}], "]"}]}], ",", "dnum"}], 
          "]"}], "&"}], ",", "idata"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"top", "=", 
      RowBox[{"dcts", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"1", ";;", 
          RowBox[{"dn", "+", "1"}]}], ",", 
         RowBox[{"1", ";;", 
          RowBox[{"dn", "+", "1"}]}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"topvecs", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"Flatten", ",", "top"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tdotv", "=", 
      RowBox[{"topvecs", ".", "vv"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"norms", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"#", ".", "#"}], "]"}], "&"}], ",", "tdotv"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"tdotv", "=", 
      RowBox[{"tdotv", "/", "norms"}]}], ";", "\[IndentingNewLine]", 
     "tdotv"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6442454853389683`*^9, 3.6442454891286573`*^9}, {
   3.644246067676279*^9, 3.644246101212682*^9}, {3.64424616929699*^9, 
   3.6442461725953608`*^9}, {3.64424620597202*^9, 3.6442462076971693`*^9}, 
   3.644246272117345*^9, {3.644246312574709*^9, 3.644246318559022*^9}, {
   3.64424767903514*^9, 3.644247703856255*^9}, 3.64424929990292*^9, {
   3.644249579191605*^9, 3.644249584404579*^9}, {3.644249673511764*^9, 
   3.644249689513082*^9}, {3.644249769721855*^9, 3.644249778237253*^9}, {
   3.644250847174396*^9, 3.644250889940976*^9}, {3.6442521595861692`*^9, 
   3.644252166032456*^9}, {3.6442524096182327`*^9, 3.644252425613566*^9}, 
   3.644252572607476*^9, {3.644253067514153*^9, 3.644253116436095*^9}, {
   3.644253155962661*^9, 3.6442531594662027`*^9}, {3.644253224764233*^9, 
   3.6442532294616127`*^9}, {3.644253333277779*^9, 3.644253353535542*^9}, {
   3.644253401486635*^9, 3.644253416864129*^9}, {3.64425349542066*^9, 
   3.644253503646022*^9}, {3.644327699662265*^9, 3.644327716829473*^9}, {
   3.6443279758251753`*^9, 3.644327988641138*^9}, 3.644328061105042*^9, {
   3.6443300072922497`*^9, 3.6443300388295937`*^9}, {3.644330074955714*^9, 
   3.64433007743823*^9}, {3.644334187686393*^9, 3.644334199461389*^9}, {
   3.644595035620726*^9, 3.644595037841281*^9}, {3.644670802337078*^9, 
   3.644670821713065*^9}, {3.644756024854946*^9, 3.644756032457802*^9}, {
   3.644756107307581*^9, 3.644756110883328*^9}, {3.644756145987925*^9, 
   3.644756151497093*^9}, {3.644791281248036*^9, 3.6447913027824173`*^9}, 
   3.6447931524858503`*^9, {3.660493448691207*^9, 3.660493465794343*^9}, {
   3.660493943729925*^9, 3.6604939470406933`*^9}, {3.660493990577284*^9, 
   3.660493992513976*^9}, {3.660497138573241*^9, 3.660497146549399*^9}, {
   3.660500709893394*^9, 3.660500729468388*^9}, {3.6605010213053017`*^9, 
   3.660501023597274*^9}, {3.660501075906205*^9, 3.660501133802681*^9}, {
   3.660501575872902*^9, 3.660501605754038*^9}, 3.660501664011427*^9, 
   3.660501760763114*^9, {3.660501947943437*^9, 3.6605019712372293`*^9}, {
   3.660502013013295*^9, 3.6605022204189777`*^9}, {3.660502263027821*^9, 
   3.660502267420054*^9}, {3.660507834398799*^9, 3.660507882230425*^9}, 
   3.6605080647483892`*^9, {3.660508099146043*^9, 3.660508128221826*^9}, 
   3.660508159686913*^9, {3.660508191427684*^9, 3.6605082241582108`*^9}, {
   3.660508285812811*^9, 3.660508286308429*^9}, {3.660508392989429*^9, 
   3.660508401782147*^9}, {3.660508433503447*^9, 3.660508438374536*^9}, {
   3.660508536365157*^9, 3.6605086923452044`*^9}, {3.660508735803215*^9, 
   3.660508742778285*^9}, 3.660509719632163*^9, {3.660509824768237*^9, 
   3.660509962264844*^9}, {3.660510027690181*^9, 3.660510036988015*^9}, {
   3.660510392081423*^9, 3.660510414894505*^9}, {3.660510477476262*^9, 
   3.660510477823174*^9}, 3.660585445101507*^9, 3.661199712716364*^9, 
   3.67430320483204*^9, {3.674303806963194*^9, 3.6743038248189507`*^9}, {
   3.6797518508732347`*^9, 3.679751881175345*^9}, {3.687548049372054*^9, 
   3.687548055386417*^9}, {3.687549181378474*^9, 3.687549184883005*^9}, {
   3.691421628937204*^9, 3.69142166083495*^9}, {3.691423525333658*^9, 
   3.6914235280205717`*^9}, {3.6914245720333*^9, 3.691424592085188*^9}, {
   3.691424788662409*^9, 3.691424791684699*^9}, {3.6914248404220657`*^9, 
   3.6914248463568783`*^9}, {3.69143637333147*^9, 3.691436374894202*^9}, {
   3.6914368043085938`*^9, 3.69143697341263*^9}, 3.691437032661166*^9, {
   3.691437099176918*^9, 3.6914371113351297`*^9}, {3.6914371481561403`*^9, 
   3.691437156930335*^9}, {3.691498633754128*^9, 3.691498725757145*^9}, {
   3.69324686557049*^9, 3.693246907273759*^9}, {3.693247680904673*^9, 
   3.693247717115848*^9}, {3.6932478634555187`*^9, 3.693247885210371*^9}, {
   3.693248031761957*^9, 3.693248041104752*^9}, {3.693253954867469*^9, 
   3.693253962640315*^9}, {3.693254009362268*^9, 3.693254016218176*^9}, {
   3.6932540742317333`*^9, 3.693254078994335*^9}, {3.6932541575235863`*^9, 
   3.693254164659815*^9}, {3.693254202916472*^9, 3.693254213473181*^9}, {
   3.698518520395404*^9, 3.698518523904312*^9}, {3.704467636883583*^9, 
   3.704467718709601*^9}, {3.704467927496517*^9, 3.704467930893424*^9}, {
   3.7044679960644293`*^9, 3.704468040665316*^9}, {3.7044680818189373`*^9, 
   3.7044680886505213`*^9}, {3.704468134817775*^9, 3.704468142187022*^9}, {
   3.717944969747799*^9, 3.717945020346381*^9}, {3.717945064700502*^9, 
   3.717945081757574*^9}},ExpressionUUID->"9d45af04-9cf0-4155-80af-\
a4d906114b25"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"keep", "=", "28"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dn", "=", "60"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dst", "=", "2"}], ";"}], "\n", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nfY", ",", "vvY"}], "}"}], "=", "\[IndentingNewLine]", 
    RowBox[{"nearestImages", "[", 
     RowBox[{
     "trainImages", ",", "\[IndentingNewLine]", "trainSetLabels", ",", 
      "\[IndentingNewLine]", "dn", ",", "dst", ",", "keep"}], "]"}]}], ";", 
   "\n", 
   RowBox[{"testvecsY", "=", "\[IndentingNewLine]", 
    RowBox[{"processInput", "[", 
     RowBox[{"testImages", ",", "vvY", ",", "dn", ",", "dst"}], "]"}]}], 
   ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MaxMemoryUsed", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.6442454853389683`*^9, 3.6442454891286573`*^9}, {
   3.644246067676279*^9, 3.644246101212682*^9}, {3.64424616929699*^9, 
   3.6442461725953608`*^9}, {3.64424620597202*^9, 3.6442462076971693`*^9}, 
   3.644246272117345*^9, {3.644246312574709*^9, 3.644246318559022*^9}, {
   3.64424767903514*^9, 3.644247703856255*^9}, 3.64424929990292*^9, {
   3.644249579191605*^9, 3.644249584404579*^9}, {3.644249673511764*^9, 
   3.644249689513082*^9}, {3.644249769721855*^9, 3.644249778237253*^9}, {
   3.644250847174396*^9, 3.644250889940976*^9}, {3.6442521595861692`*^9, 
   3.644252166032456*^9}, {3.6442524096182327`*^9, 3.644252425613566*^9}, 
   3.644252572607476*^9, {3.644253067514153*^9, 3.644253116436095*^9}, {
   3.644253155962661*^9, 3.6442531594662027`*^9}, {3.644253224764233*^9, 
   3.6442532294616127`*^9}, {3.644253333277779*^9, 3.644253353535542*^9}, {
   3.644253401486635*^9, 3.644253416864129*^9}, {3.64425349542066*^9, 
   3.644253503646022*^9}, {3.644327699662265*^9, 3.644327716829473*^9}, {
   3.6443279758251753`*^9, 3.644327988641138*^9}, 3.644328061105042*^9, {
   3.6443300072922497`*^9, 3.6443300388295937`*^9}, {3.644330074955714*^9, 
   3.64433007743823*^9}, {3.644334187686393*^9, 3.644334199461389*^9}, {
   3.644595035620726*^9, 3.644595037841281*^9}, {3.644670802337078*^9, 
   3.644670821713065*^9}, {3.644756024854946*^9, 3.644756032457802*^9}, {
   3.644756107307581*^9, 3.644756110883328*^9}, {3.644756145987925*^9, 
   3.644756151497093*^9}, {3.644791281248036*^9, 3.6447913027824173`*^9}, 
   3.6447931524858503`*^9, {3.660493448691207*^9, 3.660493465794343*^9}, {
   3.660493943729925*^9, 3.6604939470406933`*^9}, {3.660493990577284*^9, 
   3.660493992513976*^9}, {3.660497138573241*^9, 3.660497146549399*^9}, {
   3.660500709893394*^9, 3.660500729468388*^9}, {3.6605010213053017`*^9, 
   3.660501023597274*^9}, {3.660501075906205*^9, 3.660501133802681*^9}, {
   3.660501575872902*^9, 3.660501605754038*^9}, 3.660501664011427*^9, 
   3.660501760763114*^9, {3.660501947943437*^9, 3.6605019712372293`*^9}, {
   3.660502013013295*^9, 3.6605022204189777`*^9}, {3.660502263027821*^9, 
   3.660502267420054*^9}, {3.660507834398799*^9, 3.660507882230425*^9}, 
   3.6605080647483892`*^9, {3.660508099146043*^9, 3.660508128221826*^9}, 
   3.660508159686913*^9, {3.660508191427684*^9, 3.6605082241582108`*^9}, {
   3.660508285812811*^9, 3.660508286308429*^9}, {3.660508392989429*^9, 
   3.660508401782147*^9}, {3.660508433503447*^9, 3.660508438374536*^9}, {
   3.660508536365157*^9, 3.6605086923452044`*^9}, {3.660508735803215*^9, 
   3.660508742778285*^9}, 3.660509719632163*^9, {3.660509824768237*^9, 
   3.660509962264844*^9}, {3.660510027690181*^9, 3.660510036988015*^9}, {
   3.660510392081423*^9, 3.660510414894505*^9}, {3.660510477476262*^9, 
   3.660510477823174*^9}, 3.660585445101507*^9, 3.661199712716364*^9, {
   3.67430320483204*^9, 3.674303207614336*^9}, {3.687547889340136*^9, 
   3.687547898557004*^9}, 3.687547949512529*^9, 3.6875483098305073`*^9, {
   3.687548449686432*^9, 3.68754848589095*^9}, {3.687548547224719*^9, 
   3.687548561189705*^9}, {3.687548591366775*^9, 3.687548634561781*^9}, {
   3.687548746362693*^9, 3.687548878743949*^9}, {3.687548973502172*^9, 
   3.687549152511661*^9}, {3.687549209169293*^9, 3.687549225649551*^9}, {
   3.688228463536532*^9, 3.6882284849609756`*^9}, {3.688228517249324*^9, 
   3.6882285613454514`*^9}, {3.688228591377685*^9, 3.688228630866818*^9}, 
   3.68823046960347*^9, {3.6882305010691423`*^9, 3.688230600253834*^9}, {
   3.688230638256983*^9, 3.6882306576667223`*^9}, 3.6882307046775618`*^9, {
   3.6882307397658653`*^9, 3.688230740259795*^9}, 3.688230775431211*^9, 
   3.688230810751754*^9, {3.688230842455965*^9, 3.688230843269392*^9}, 
   3.688230878456521*^9, {3.6882310002969427`*^9, 3.6882310009196777`*^9}, 
   3.688231046563114*^9, {3.688242862636919*^9, 3.6882428735978413`*^9}, {
   3.6882429223183327`*^9, 3.6882429481913652`*^9}, 3.6882429921937237`*^9, {
   3.688497305137673*^9, 3.688497316980101*^9}, {3.700397869170513*^9, 
   3.700397965637865*^9}, {3.700398003556919*^9, 3.70039802730094*^9}, {
   3.7004018285203047`*^9, 3.7004018289579268`*^9}, {3.700401864123055*^9, 
   3.700401864617674*^9}, {3.700402042050768*^9, 3.700402069778425*^9}, 
   3.700402186548575*^9, {3.700402218597187*^9, 3.700402222271409*^9}, {
   3.7004023931442013`*^9, 3.7004024357369967`*^9}, {3.700402735063571*^9, 
   3.700402819543619*^9}, {3.700403790987541*^9, 3.700403816715867*^9}, {
   3.700420749751676*^9, 3.700420750294734*^9}, {3.700420789710732*^9, 
   3.7004207901675463`*^9}, {3.704221131214065*^9, 3.7042211469426947`*^9}, {
   3.704221212031892*^9, 3.704221215582292*^9}, {3.7042214456992292`*^9, 
   3.70422144611383*^9}, {3.7042216738619833`*^9, 3.704221674549549*^9}, {
   3.704447199386799*^9, 3.704447205009899*^9}, {3.704447421495417*^9, 
   3.704447539863035*^9}, {3.704447652714962*^9, 3.704447668617454*^9}, {
   3.704447715506831*^9, 3.7044477672536507`*^9}, {3.7044478086474247`*^9, 
   3.704447836235368*^9}, {3.704447874922967*^9, 3.704447972416581*^9}, {
   3.704448003233111*^9, 3.704448084698977*^9}, {3.704455652772579*^9, 
   3.704455653301939*^9}, {3.704455741332973*^9, 3.704455937996162*^9}, {
   3.704455973438981*^9, 3.704456066720181*^9}, {3.704456293233082*^9, 
   3.704456299155748*^9}, {3.7044563360755863`*^9, 3.704456370045959*^9}, 
   3.70445664365904*^9, {3.704457263819941*^9, 3.704457441211755*^9}, {
   3.704457608628068*^9, 3.7044576092834682`*^9}, {3.704457659942769*^9, 
   3.704457680276312*^9}, {3.7044597620510893`*^9, 3.704459773631227*^9}, {
   3.704459809779705*^9, 3.704459811824211*^9}, {3.7044598717506113`*^9, 
   3.704459872275766*^9}, 3.704459962583699*^9, {3.704460273673768*^9, 
   3.7044602739010897`*^9}, 3.704462543550007*^9, {3.704462657352312*^9, 
   3.704462658620056*^9}, 3.704462772938259*^9, {3.7044632355216217`*^9, 
   3.704463235776166*^9}, {3.704463294232628*^9, 3.704463294821904*^9}, {
   3.704463687136327*^9, 3.7044636881738167`*^9}, {3.704463917651185*^9, 
   3.704463974357308*^9}, {3.7044651555698833`*^9, 3.7044652053983727`*^9}, 
   3.7044653928255873`*^9, {3.704465440626658*^9, 3.704465441372603*^9}, 
   3.704467168450675*^9, 3.704467207074862*^9, {3.704467242108683*^9, 
   3.7044672692480097`*^9}, {3.7044673274065447`*^9, 3.704467470452889*^9}, 
   3.7130366224144707`*^9, {3.713037325374784*^9, 3.713037341836486*^9}, 
   3.713037439424604*^9, {3.713037518334291*^9, 3.713037518888538*^9}, {
   3.7130375839844933`*^9, 3.713037591822641*^9}, {3.7130376443392153`*^9, 
   3.713037644826963*^9}, {3.713037740977817*^9, 3.713037741312731*^9}, {
   3.7130377721089277`*^9, 3.713037774255609*^9}, {3.713037813317443*^9, 
   3.713037814001626*^9}, {3.713037861382249*^9, 3.7130378618731203`*^9}, {
   3.713093181690544*^9, 3.713093182406066*^9}, {3.7130932426998787`*^9, 
   3.7130933875528297`*^9}, 3.713093542501822*^9, {3.713093648564125*^9, 
   3.713093678116894*^9}, {3.713093713974132*^9, 3.7130937143552513`*^9}, 
   3.7130937488959293`*^9, {3.7130938227756567`*^9, 3.7130938234286203`*^9}, {
   3.713093891975803*^9, 3.7130938932687798`*^9}, 3.713093950694632*^9, 
   3.713094010872982*^9, {3.7130940564508266`*^9, 3.7130940569562483`*^9}, 
   3.7130942081909733`*^9, 3.713094279972083*^9, 3.7130943421067257`*^9, 
   3.71309657688883*^9, {3.713096858220663*^9, 3.713096866565352*^9}, {
   3.713097241575037*^9, 3.713097242308416*^9}, {3.71309728389708*^9, 
   3.713097286021047*^9}, 3.713097346952568*^9, 3.7130973812896547`*^9, {
   3.713097429305867*^9, 3.71309743845547*^9}, {3.7130974966278343`*^9, 
   3.7130975022476597`*^9}, 3.713097539290483*^9, {3.713097582092887*^9, 
   3.713097582709236*^9}, 3.713097616393117*^9, {3.7130976838369617`*^9, 
   3.7130978029855623`*^9}, 3.713102309374164*^9, {3.713102452890555*^9, 
   3.713102453100018*^9}, {3.713102989430312*^9, 3.713102989697599*^9}, {
   3.713106520210726*^9, 3.713106520464232*^9}, {3.713116959741149*^9, 
   3.71311696047407*^9}, {3.713117830564972*^9, 3.713117831345042*^9}, {
   3.717876314120668*^9, 3.717876375058448*^9}, {3.717876406713524*^9, 
   3.717876436618194*^9}, {3.7178764845549173`*^9, 3.717876545397142*^9}, {
   3.7179449448419447`*^9, 3.717944945506798*^9}, {3.717945235325926*^9, 
   3.71794525394633*^9}, {3.7179574114145117`*^9, 3.7179574451742268`*^9}, {
   3.718061514830543*^9, 
   3.718061558675796*^9}},ExpressionUUID->"a50fc285-7acf-4631-a9b4-\
93c376b1b10e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.625419`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7131842510988607`*^9, 3.7131843909138813`*^9, 3.7131844324157133`*^9, 
   3.713187612617351*^9, 3.713187813857563*^9, 3.7131878689139338`*^9, 
   3.7131879786127243`*^9, 3.713188240107246*^9, 3.7131887728810577`*^9, 
   3.717876270323243*^9, {3.7178763165607433`*^9, 3.717876376570148*^9}, {
   3.717876408224083*^9, 3.717876547073771*^9}, {3.7179412446823807`*^9, 
   3.7179412814936447`*^9}, 3.717944947360217*^9, 3.717945026905382*^9, 
   3.71794508607753*^9, {3.717945230202401*^9, 3.717945255702815*^9}, 
   3.717946034832004*^9, 3.717957376095948*^9, {3.717957415351862*^9, 
   3.71795744722827*^9}, 3.717958147831482*^9, 3.7179646717440233`*^9, {
   3.7180614887623777`*^9, 
   3.718061559876667*^9}},ExpressionUUID->"ca5d8ed6-bdca-4c5c-ab7f-\
316604d25d4c"],

Cell[BoxData["2724617144"], "Output",
 CellChangeTimes->{
  3.7131842510988607`*^9, 3.7131843909138813`*^9, 3.7131844324157133`*^9, 
   3.713187612617351*^9, 3.713187813857563*^9, 3.7131878689139338`*^9, 
   3.7131879786127243`*^9, 3.713188240107246*^9, 3.7131887728810577`*^9, 
   3.717876270323243*^9, {3.7178763165607433`*^9, 3.717876376570148*^9}, {
   3.717876408224083*^9, 3.717876547073771*^9}, {3.7179412446823807`*^9, 
   3.7179412814936447`*^9}, 3.717944947360217*^9, 3.717945026905382*^9, 
   3.71794508607753*^9, {3.717945230202401*^9, 3.717945255702815*^9}, 
   3.717946034832004*^9, 3.717957376095948*^9, {3.717957415351862*^9, 
   3.71795744722827*^9}, 3.717958147831482*^9, 3.7179646717440233`*^9, {
   3.7180614887623777`*^9, 
   3.7180615598774633`*^9}},ExpressionUUID->"2a255dc4-e3c4-428a-b5e7-\
ee4faaca757b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nnbrs", "=", "16"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nbrScores", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"nbrlist", "=", 
       RowBox[{"nfY", "[", 
        RowBox[{
         RowBox[{"testvecsY", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", "nnbrs"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dists", "=", 
       RowBox[{"1", "/", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", 
            RowBox[{
             RowBox[{"testvecsY", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "-", "#"}], "]"}], "&"}], ",", 
          RowBox[{"nbrlist", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nbrlist", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"dists", "/", 
          RowBox[{"Total", "[", "dists", "]"}]}]}], "}"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", "testvecsY", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nbrScoresCollected", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Take", "[", 
       RowBox[{
        RowBox[{"SortBy", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], ",", 
        RowBox[{"UpTo", "[", "4", "]"}]}], "]"}], "&"}], ",", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"GroupBy", "[", 
           RowBox[{"#", ",", "First"}], "]"}], "]"}], "&"}], ",", 
        "nbrScores"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"val_", "\[Rule]", 
         RowBox[{"vlist", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"val_", ",", "_"}], "}"}], ".."}], "}"}]}]}], ")"}], 
       "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{"val", "\[Rule]", 
         RowBox[{"Total", "[", 
          RowBox[{"vlist", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ")"}]}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allFTTPCAScores", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"testauthors", "/.", "nbrScoresCollected"}], ")"}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{"testauthors", "\[Rule]", "0.0"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"testSetLabels", ",", "nbrScoresCollected"}], "}"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"firsts", "=", 
  RowBox[{
   RowBox[{"Cases", "[", 
    RowBox[{"results", ",", 
     RowBox[{"{", 
      RowBox[{"a_", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a_", "\[Rule]", "_"}], ",", "___"}], "}"}]}], "}"}]}], 
    "]"}], "//", "Length"}]}], "\[IndentingNewLine]", 
 RowBox[{"seconds", "=", 
  RowBox[{
   RowBox[{"Cases", "[", 
    RowBox[{"results", ",", 
     RowBox[{"{", 
      RowBox[{"a_", ",", 
       RowBox[{"{", 
        RowBox[{"_", ",", 
         RowBox[{"a_", "\[Rule]", "_"}], ",", "___"}], "}"}]}], "}"}]}], 
    "]"}], "//", "Length"}]}], "\[IndentingNewLine]", 
 RowBox[{"tot", "=", 
  RowBox[{"firsts", "+", "seconds"}]}]}], "Input",
 CellChangeTimes->{
  3.7044563200593452`*^9, {3.704456412444529*^9, 3.7044566850108356`*^9}, {
   3.704456762699773*^9, 3.70445677449403*^9}, {3.704456838415863*^9, 
   3.704456910094076*^9}, {3.704456971217635*^9, 3.704456991811977*^9}, {
   3.7044570285260077`*^9, 3.704457035072138*^9}, {3.704457197769554*^9, 
   3.704457234606378*^9}, {3.704457621238717*^9, 3.70445767541293*^9}, {
   3.7044577115530567`*^9, 3.704457716017415*^9}, {3.704459618805538*^9, 
   3.704459636607662*^9}, {3.704459676463854*^9, 3.7044596870070953`*^9}, {
   3.704459724887166*^9, 3.704459735300078*^9}, {3.704459780991856*^9, 
   3.704459797799021*^9}, {3.704459829463106*^9, 3.704459840736287*^9}, {
   3.704459885592306*^9, 3.704459900724327*^9}, {3.704459980534046*^9, 
   3.70446000214747*^9}, {3.7044602950891438`*^9, 3.7044602964100437`*^9}, 
   3.704462607259688*^9, {3.7130366468602657`*^9, 3.713036650844221*^9}, {
   3.7130366888176126`*^9, 3.713036706433505*^9}, {3.713037376256699*^9, 
   3.71303743273678*^9}, {3.713037472304983*^9, 3.713037507547489*^9}, {
   3.713037556705635*^9, 3.7130375724505577`*^9}, {3.713037633723925*^9, 
   3.7130376382110643`*^9}, {3.713037846621365*^9, 3.7130378518282843`*^9}, {
   3.713037899059073*^9, 3.713037947233687*^9}, {3.713093223280034*^9, 
   3.7130932360127277`*^9}, {3.713093780293095*^9, 3.7130938169680243`*^9}, {
   3.7130938559882708`*^9, 3.713093886181004*^9}, {3.7130939280232983`*^9, 
   3.71309394480079*^9}, {3.7130939969655333`*^9, 3.713094006434276*^9}, {
   3.713094059987442*^9, 3.7130940723401737`*^9}, {3.7130941885694847`*^9, 
   3.713094204011942*^9}, {3.713094247676222*^9, 3.7130942718594513`*^9}, {
   3.713094331574491*^9, 3.7130943391430798`*^9}, {3.713096540013254*^9, 
   3.71309655850449*^9}, {3.713096607037661*^9, 3.713096634281557*^9}, {
   3.7130968349769363`*^9, 3.713096852066016*^9}, {3.7130972059727488`*^9, 
   3.7130972160157022`*^9}, {3.7130973216018047`*^9, 3.7130973389465*^9}, {
   3.7130974147301397`*^9, 3.7130974194348087`*^9}, {3.713097474744299*^9, 
   3.713097491509034*^9}, 3.713097534204368*^9, {3.713097574634307*^9, 
   3.713097579877808*^9}, {3.7130976435001497`*^9, 3.713097677550456*^9}, {
   3.71309782612794*^9, 3.7130978887068243`*^9}, {3.713100616949972*^9, 
   3.713100644581579*^9}, {3.713102271400485*^9, 3.7131022722632313`*^9}, 
   3.713103024455152*^9, 3.713106555929336*^9, {3.713114129861209*^9, 
   3.713114177154538*^9}, 3.7131142322250853`*^9, {3.713116988790822*^9, 
   3.7131169892702312`*^9}, {3.713117269552376*^9, 3.713117278814995*^9}, {
   3.7131175414125834`*^9, 3.713117542258644*^9}, 3.713117759313418*^9, {
   3.713117813015285*^9, 3.713117824258321*^9}, {3.713117882250367*^9, 
   3.713117917238367*^9}, {3.713118254383279*^9, 3.7131182831655684`*^9}, {
   3.713118936263279*^9, 3.713118970168867*^9}, {3.713119083782961*^9, 
   3.71311909826045*^9}, {3.713119360103773*^9, 3.713119382168631*^9}, {
   3.713119625649932*^9, 3.713119696379734*^9}, {3.71312002371804*^9, 
   3.713120023952462*^9}, {3.713120090328555*^9, 3.713120137441846*^9}, {
   3.7131205239313707`*^9, 3.713120545320408*^9}, {3.713121563126066*^9, 
   3.713121572733531*^9}, {3.71312175911273*^9, 3.713121770816481*^9}, {
   3.713122243670464*^9, 3.713122267232306*^9}, {3.713184269768298*^9, 
   3.713184337705345*^9}, 3.7131843998345747`*^9, {3.713184442420123*^9, 
   3.7131844491268*^9}, {3.7131876289349117`*^9, 3.7131876625813837`*^9}, 
   3.71318787366743*^9, {3.713187982459734*^9, 3.713188020492206*^9}, {
   3.7178763274960537`*^9, 3.717876393929603*^9}, {3.717876491620275*^9, 
   3.717876502395598*^9}, {3.717876560169434*^9, 3.717876566951247*^9}, {
   3.717934690647579*^9, 3.71793469131952*^9}, {3.717941041010332*^9, 
   3.7179410895553827`*^9}, {3.717941249841775*^9, 3.717941253591847*^9}, {
   3.717944953852582*^9, 3.717944961476038*^9}, {3.7179450323644857`*^9, 
   3.717945047517055*^9}, {3.717946041060217*^9, 3.717946055434204*^9}, {
   3.7179573817974997`*^9, 3.7179574047265263`*^9}, 3.717957881132812*^9, 
   3.7179581515060797`*^9, 
   3.7180615065765867`*^9},ExpressionUUID->"7b15248b-e5b6-47ed-814a-\
d99d240c7ccc"],

Cell[BoxData["325"], "Output",
 CellChangeTimes->{{3.7131842538177557`*^9, 3.713184338449585*^9}, {
   3.713184392443137*^9, 3.7131844009741173`*^9}, {3.7131844341151657`*^9, 
   3.713184449887027*^9}, {3.713187612682825*^9, 3.713187664162994*^9}, 
   3.713187815442297*^9, {3.713187870666955*^9, 3.7131878744439907`*^9}, {
   3.713187979712099*^9, 3.713188021757153*^9}, 3.713188240171299*^9, 
   3.7131887729468317`*^9, 3.717876276479858*^9, {3.717876317871932*^9, 
   3.717876568911626*^9}, 3.7179346927025833`*^9, {3.717941042843361*^9, 
   3.717941090346943*^9}, {3.7179412474674892`*^9, 3.71794128309126*^9}, {
   3.7179449491435757`*^9, 3.71794496339139*^9}, {3.717945028216202*^9, 
   3.717945048255434*^9}, 3.717945089566415*^9, {3.7179452319618273`*^9, 
   3.717945257231783*^9}, {3.717946036622344*^9, 3.717946056061143*^9}, {
   3.717957378443651*^9, 3.7179574486702347`*^9}, 3.7179578830832157`*^9, {
   3.717958149102783*^9, 3.717958152463306*^9}, 3.717964671922311*^9, {
   3.718061493125691*^9, 
   3.7180615609111423`*^9}},ExpressionUUID->"6e9b6386-49d6-4a6a-b016-\
2a4bce086f4c"],

Cell[BoxData["122"], "Output",
 CellChangeTimes->{{3.7131842538177557`*^9, 3.713184338449585*^9}, {
   3.713184392443137*^9, 3.7131844009741173`*^9}, {3.7131844341151657`*^9, 
   3.713184449887027*^9}, {3.713187612682825*^9, 3.713187664162994*^9}, 
   3.713187815442297*^9, {3.713187870666955*^9, 3.7131878744439907`*^9}, {
   3.713187979712099*^9, 3.713188021757153*^9}, 3.713188240171299*^9, 
   3.7131887729468317`*^9, 3.717876276479858*^9, {3.717876317871932*^9, 
   3.717876568911626*^9}, 3.7179346927025833`*^9, {3.717941042843361*^9, 
   3.717941090346943*^9}, {3.7179412474674892`*^9, 3.71794128309126*^9}, {
   3.7179449491435757`*^9, 3.71794496339139*^9}, {3.717945028216202*^9, 
   3.717945048255434*^9}, 3.717945089566415*^9, {3.7179452319618273`*^9, 
   3.717945257231783*^9}, {3.717946036622344*^9, 3.717946056061143*^9}, {
   3.717957378443651*^9, 3.7179574486702347`*^9}, 3.7179578830832157`*^9, {
   3.717958149102783*^9, 3.717958152463306*^9}, 3.717964671922311*^9, {
   3.718061493125691*^9, 
   3.718061560911973*^9}},ExpressionUUID->"518bbfef-5846-4baa-aa63-\
086269492060"],

Cell[BoxData["447"], "Output",
 CellChangeTimes->{{3.7131842538177557`*^9, 3.713184338449585*^9}, {
   3.713184392443137*^9, 3.7131844009741173`*^9}, {3.7131844341151657`*^9, 
   3.713184449887027*^9}, {3.713187612682825*^9, 3.713187664162994*^9}, 
   3.713187815442297*^9, {3.713187870666955*^9, 3.7131878744439907`*^9}, {
   3.713187979712099*^9, 3.713188021757153*^9}, 3.713188240171299*^9, 
   3.7131887729468317`*^9, 3.717876276479858*^9, {3.717876317871932*^9, 
   3.717876568911626*^9}, 3.7179346927025833`*^9, {3.717941042843361*^9, 
   3.717941090346943*^9}, {3.7179412474674892`*^9, 3.71794128309126*^9}, {
   3.7179449491435757`*^9, 3.71794496339139*^9}, {3.717945028216202*^9, 
   3.717945048255434*^9}, 3.717945089566415*^9, {3.7179452319618273`*^9, 
   3.717945257231783*^9}, {3.717946036622344*^9, 3.717946056061143*^9}, {
   3.717957378443651*^9, 3.7179574486702347`*^9}, 3.7179578830832157`*^9, {
   3.717958149102783*^9, 3.717958152463306*^9}, 3.717964671922311*^9, {
   3.718061493125691*^9, 
   3.718061560912673*^9}},ExpressionUUID->"673cffdb-c7aa-4b54-ad49-\
31d2f5705cb1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"preprocFunc", "=", "Identity"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SeedRandom", "[", "11112222", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"cfunc", "=", 
    RowBox[{"Classify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"preprocFunc", ",", "trainImages"}], "]"}], "->", 
       "trainSetLabels"}], ",", " ", 
      RowBox[{"Method", "\[Rule]", "\"\<LogisticRegression\>\""}], ",", 
      RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "]"}], "\n", 
 RowBox[{"MaxMemoryUsed", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"resultprobsraw", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"testauthors", "/.", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"cfunc", "[", 
           RowBox[{"#", ",", "\"\<Probabilities\>\""}], "]"}], "&"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{"preprocFunc", ",", "testImages"}], "]"}]}], "]"}]}], ")"}],
      "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{"testauthors", "\[RuleDelayed]", "0"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MaxMemoryUsed", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.7179532992467527`*^9, 3.717953336445546*^9}, {
   3.717953421725968*^9, 3.717953431666651*^9}, {3.717953617330501*^9, 
   3.717953623554619*^9}, {3.717953807676262*^9, 3.717953820788212*^9}, {
   3.717954254271549*^9, 3.717954255194186*^9}, {3.7179551058222237`*^9, 
   3.717955106870097*^9}, {3.717955297625203*^9, 3.71795530047674*^9}, {
   3.717956651082727*^9, 3.717956656640094*^9}, {3.717956823326498*^9, 
   3.717956824787179*^9}, {3.717957033889633*^9, 3.7179570372387877`*^9}, {
   3.7179571838823233`*^9, 3.7179571851231737`*^9}, {3.7179575078320208`*^9, 
   3.717957509430936*^9}, {3.717957596779014*^9, 3.717957605738336*^9}, {
   3.717957936661208*^9, 3.7179579720292387`*^9}, {3.7179580165755997`*^9, 
   3.717958040926138*^9}, 3.717958080016019*^9, {3.717958281368784*^9, 
   3.717958300099422*^9}, {3.717958363524466*^9, 
   3.7179583647706633`*^9}},ExpressionUUID->"abb7909d-b005-4e65-b479-\
5ee46d88600c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6.406043`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.717956748099852*^9, 3.717956928895485*^9, 3.717957106968858*^9, 
   3.717957245158557*^9, 3.717957431649993*^9, 3.717957573873637*^9, 
   3.7179576515622377`*^9, 3.7179579472881413`*^9, 3.717957979861835*^9, {
   3.7179580251715717`*^9, 3.717958049097598*^9}, 3.717958172475729*^9, {
   3.717958290273703*^9, 3.717958307554756*^9}, 3.7179583734091997`*^9, 
   3.71806157418891*^9, 
   3.71806162844902*^9},ExpressionUUID->"670aa0de-d5d9-40ca-b75b-\
2dc45d6f55b3"],

Cell[BoxData["2724617144"], "Output",
 CellChangeTimes->{
  3.717956748099852*^9, 3.717956928895485*^9, 3.717957106968858*^9, 
   3.717957245158557*^9, 3.717957431649993*^9, 3.717957573873637*^9, 
   3.7179576515622377`*^9, 3.7179579472881413`*^9, 3.717957979861835*^9, {
   3.7179580251715717`*^9, 3.717958049097598*^9}, 3.717958172475729*^9, {
   3.717958290273703*^9, 3.717958307554756*^9}, 3.7179583734091997`*^9, 
   3.71806157418891*^9, 
   3.718061628453064*^9},ExpressionUUID->"f8a652b8-43a9-403b-8cbd-\
5e63e4b9d545"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.951087`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.717956748099852*^9, 3.717956928895485*^9, 3.717957106968858*^9, 
   3.717957245158557*^9, 3.717957431649993*^9, 3.717957573873637*^9, 
   3.7179576515622377`*^9, 3.7179579472881413`*^9, 3.717957979861835*^9, {
   3.7179580251715717`*^9, 3.717958049097598*^9}, 3.717958172475729*^9, {
   3.717958290273703*^9, 3.717958307554756*^9}, 3.7179583734091997`*^9, 
   3.71806157418891*^9, 
   3.718061632400923*^9},ExpressionUUID->"176934fd-6393-464f-9e9a-\
841687b1ffe0"],

Cell[BoxData["2724617144"], "Output",
 CellChangeTimes->{
  3.717956748099852*^9, 3.717956928895485*^9, 3.717957106968858*^9, 
   3.717957245158557*^9, 3.717957431649993*^9, 3.717957573873637*^9, 
   3.7179576515622377`*^9, 3.7179579472881413`*^9, 3.717957979861835*^9, {
   3.7179580251715717`*^9, 3.717958049097598*^9}, 3.717958172475729*^9, {
   3.717958290273703*^9, 3.717958307554756*^9}, 3.7179583734091997`*^9, 
   3.71806157418891*^9, 
   3.71806163240237*^9},ExpressionUUID->"a378b4d5-66fd-40d5-8e37-\
348c6c5f32a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"results", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"testSetLabels", ",", "resultprobsraw"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results1", "=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Ordering", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], "&"}], ",", "results"}],
      "]"}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "testauthors", "]"}], "]"}], "\[Rule]", 
      "testauthors"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"Tally", "[", "results1", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"results2", "=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Ordering", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"-", "2"}], "]"}], "]"}]}], "}"}], "&"}], ",", "results"}],
      "]"}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "testauthors", "]"}], "]"}], "\[Rule]", 
      "testauthors"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2", "=", 
   RowBox[{"Tally", "[", "results2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results3", "=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Ordering", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"-", "3"}], "]"}], "]"}]}], "}"}], "&"}], ",", "results"}],
      "]"}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "testauthors", "]"}], "]"}], "\[Rule]", 
      "testauthors"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t3", "=", 
   RowBox[{"Tally", "[", "results3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results4", "=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Ordering", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"-", "4"}], "]"}], "]"}]}], "}"}], "&"}], ",", "results"}],
      "]"}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "testauthors", "]"}], "]"}], "\[Rule]", 
      "testauthors"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t4", "=", 
   RowBox[{"Tally", "[", "results4", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c1", "=", 
   RowBox[{"Total", "[", 
    RowBox[{"Cases", "[", 
     RowBox[{"t1", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"s_", ",", "s_"}], "}"}], ",", "v_"}], "}"}], 
       "\[RuleDelayed]", "v"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"c2", "=", 
   RowBox[{"Total", "[", 
    RowBox[{"Cases", "[", 
     RowBox[{"t2", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"s_", ",", "s_"}], "}"}], ",", "v_"}], "}"}], 
       "\[RuleDelayed]", "v"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{"c1", ",", "c2"}], "}"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"c1", ",", "c2"}], "}"}], "/", "500."}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"c1", "+", "c2"}], ")"}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"c1", "+", "c2"}], ")"}], "/", "500."}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.7130987636730547`*^9, 3.713098802206002*^9}, 
   3.717951235827222*^9, 3.7179513114468737`*^9, {3.7179514764117317`*^9, 
   3.71795148363804*^9}, {3.7179515404114733`*^9, 3.717951557509583*^9}, {
   3.717953386102849*^9, 3.7179533981022243`*^9}, 3.717953537056748*^9, 
   3.717953570929131*^9, 3.717953790682863*^9, {3.717954436405005*^9, 
   3.717954457068903*^9}, {3.7179563669038563`*^9, 3.717956382968267*^9}, {
   3.717957675705167*^9, 3.717957701657916*^9}, {3.717957786986805*^9, 
   3.717957892110819*^9}, 3.717957957508462*^9, {3.717957997253509*^9, 
   3.7179580086226473`*^9}, {3.717958063636441*^9, 
   3.7179580677583942`*^9}},ExpressionUUID->"ae273c8e-09c6-4584-a082-\
46ecc7cf3291"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"411", ",", "66"}], "}"}]], "Output",
 CellChangeTimes->{
  3.717957707940249*^9, {3.717957799095415*^9, 3.717957894242848*^9}, {
   3.717957954666963*^9, 3.7179579581733513`*^9}, {3.717957988402011*^9, 
   3.717958034934437*^9}, 3.717958069971134*^9, {3.717958178362109*^9, 
   3.717958180784464*^9}, {3.717958295156508*^9, 3.717958311532442*^9}, 
   3.7179583850302467`*^9, 3.7180615813081903`*^9, 
   3.7180616337179623`*^9},ExpressionUUID->"542bb36a-8719-46e8-b2f8-\
8b79481d0229"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8220000000000001`", ",", "0.132`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.717957707940249*^9, {3.717957799095415*^9, 3.717957894242848*^9}, {
   3.717957954666963*^9, 3.7179579581733513`*^9}, {3.717957988402011*^9, 
   3.717958034934437*^9}, 3.717958069971134*^9, {3.717958178362109*^9, 
   3.717958180784464*^9}, {3.717958295156508*^9, 3.717958311532442*^9}, 
   3.7179583850302467`*^9, 3.7180615813081903`*^9, 
   3.7180616337212687`*^9},ExpressionUUID->"8b0dd1aa-1425-40d5-a52b-\
7d968c5c07f3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"477", ",", "0.9540000000000001`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.717957707940249*^9, {3.717957799095415*^9, 3.717957894242848*^9}, {
   3.717957954666963*^9, 3.7179579581733513`*^9}, {3.717957988402011*^9, 
   3.717958034934437*^9}, 3.717958069971134*^9, {3.717958178362109*^9, 
   3.717958180784464*^9}, {3.717958295156508*^9, 3.717958311532442*^9}, 
   3.7179583850302467`*^9, 3.7180615813081903`*^9, 
   3.718061633723948*^9},ExpressionUUID->"3ee7ddb8-4ff0-4be6-85c2-\
ea3d938d56e7"]
}, Open  ]],

Cell["So 82.2% correct and another 13.2% are the second guess.", "Text",
 CellChangeTimes->{{3.717958393330855*^9, 3.717958411894739*^9}, {
  3.7180617937915277`*^9, 
  3.71806179795154*^9}},ExpressionUUID->"3f087dc8-513b-4a51-ad94-\
05a8cff51959"]
},
WindowSize->{804, 906},
WindowMargins->{{303, Automatic}, {17, Automatic}},
FrontEndVersion->"11.1 for Linux x86 (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 205, 5, 34, "Input", "ExpressionUUID" -> \
"1ba9cb42-a46b-49da-afc5-b94fd66402a6"],
Cell[766, 27, 237, 6, 33, "Text", "ExpressionUUID" -> \
"30840753-515a-49bf-a11b-4bf6378713d9"],
Cell[CellGroupData[{
Cell[1028, 37, 2839, 79, 351, "Input", "ExpressionUUID" -> \
"032f0415-c721-4535-b2f5-0baf381a9383"],
Cell[3870, 118, 255, 6, 34, "Output", "ExpressionUUID" -> \
"70e40b59-1d0e-4583-bef6-264217049fb9"],
Cell[4128, 126, 255, 6, 34, "Output", "ExpressionUUID" -> \
"7c4e3b0e-f738-40b4-8f6e-0a8fc43d74c4"],
Cell[4386, 134, 206, 4, 32, "Output", "ExpressionUUID" -> \
"6104dcac-1c0d-48a1-a94e-f48dd97bcf01"]
}, Open  ]],
Cell[4607, 141, 1353, 24, 147, "Input", "ExpressionUUID" -> \
"9db68738-8811-416f-8bd4-6858867dd6f3"],
Cell[CellGroupData[{
Cell[5985, 169, 3686, 92, 550, "Input", "ExpressionUUID" -> \
"deb64c15-4bc3-48f5-89b2-eefe2f7b9207"],
Cell[9674, 263, 259, 6, 34, "Output", "ExpressionUUID" -> \
"dcd32e6f-651d-4d02-8cc2-399974ef37fc"],
Cell[9936, 271, 257, 6, 34, "Output", "ExpressionUUID" -> \
"03a63fec-685a-4f8e-a83d-2fb1dd57a562"],
Cell[10196, 279, 258, 6, 34, "Output", "ExpressionUUID" -> \
"76f411ae-9f1a-40be-8934-c67f4cbcd58f"],
Cell[10457, 287, 257, 6, 34, "Output", "ExpressionUUID" -> \
"d66c1965-9c49-4ef1-af1d-e7ce14eb7bae"],
Cell[10717, 295, 209, 4, 32, "Output", "ExpressionUUID" -> \
"e35fda2b-1732-46b0-9840-eb27249ba9ae"]
}, Open  ]],
Cell[10941, 302, 2763, 75, 262, "Input", "ExpressionUUID" -> \
"bad76b23-2661-4d10-a325-258e147d4d22"],
Cell[CellGroupData[{
Cell[13729, 381, 6273, 110, 192, "Input", "ExpressionUUID" -> \
"b5848e6b-7d4a-41ed-9801-4286ce5b5790"],
Cell[20005, 493, 397, 8, 34, "Output", "ExpressionUUID" -> \
"cb05cf82-bbc6-42f8-928a-9b565311b8fc"],
Cell[20405, 503, 397, 8, 34, "Output", "ExpressionUUID" -> \
"d472b79b-1234-4c78-bf44-e0a87f4cac6e"],
Cell[20805, 513, 349, 6, 32, "Output", "ExpressionUUID" -> \
"f3d6bf58-3d91-4c96-aa00-d9181a051e12"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21191, 524, 4089, 96, 328, "Input", "ExpressionUUID" -> \
"5d3d7336-57d4-41ea-aec5-821187046e43"],
Cell[25283, 622, 974, 15, 32, "Output", "ExpressionUUID" -> \
"66899131-45b4-45c4-b081-674890237ae8"],
Cell[26260, 639, 966, 15, 32, "Output", "ExpressionUUID" -> \
"349a6651-aede-4c4b-ae6b-2443c1db4137"],
Cell[27229, 656, 974, 15, 32, "Output", "ExpressionUUID" -> \
"5e479fb5-0a0d-4b9f-8304-500167b9f7e5"]
}, Open  ]],
Cell[28218, 674, 8611, 172, 582, "Input", "ExpressionUUID" -> \
"a8458225-6f1a-4622-a082-960f3400a1ff"],
Cell[CellGroupData[{
Cell[36854, 850, 9230, 137, 239, "Input", "ExpressionUUID" -> \
"d131da42-2602-4c59-8c19-64f261ebd9e5"],
Cell[46087, 989, 874, 15, 34, "Output", "ExpressionUUID" -> \
"94b89ba1-77d0-4427-aa28-ecdc15c977af"],
Cell[46964, 1006, 829, 13, 32, "Output", "ExpressionUUID" -> \
"83c4fd1a-c323-42e3-acf0-09acff1365cb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47830, 1024, 7753, 170, 286, "Input", "ExpressionUUID" -> \
"4d6eac59-653c-4f90-a1e5-10ad2299962c"],
Cell[55586, 1196, 1097, 16, 32, "Output", "ExpressionUUID" -> \
"535aa778-7d29-4b8c-8170-106ab4388ea9"],
Cell[56686, 1214, 1095, 16, 32, "Output", "ExpressionUUID" -> \
"a9e030f1-c7a5-424c-8c8d-03babaecc5ca"],
Cell[57784, 1232, 1095, 16, 32, "Output", "ExpressionUUID" -> \
"39cd8c1d-93ab-4439-9c50-473527be08ed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58916, 1253, 2329, 50, 303, "Input", "ExpressionUUID" -> \
"629b4e12-27b0-4248-b146-b7c1f2cbc98b"],
Cell[61248, 1305, 572, 11, 34, "Output", "ExpressionUUID" -> \
"13c3cabc-ace6-40c3-a58a-d8fc04b3a8ea"],
Cell[61823, 1318, 526, 9, 32, "Output", "ExpressionUUID" -> \
"5b7d8f3e-eb29-41ae-88e1-acc08d955db0"],
Cell[62352, 1329, 573, 11, 34, "Output", "ExpressionUUID" -> \
"5ef041e6-2732-461d-95fe-93fca1c7c76f"],
Cell[62928, 1342, 525, 9, 32, "Output", "ExpressionUUID" -> \
"e276e162-2421-4bda-995b-02b3f2289b3a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63490, 1356, 5117, 152, 425, "Input", "ExpressionUUID" -> \
"25583c2b-94a7-4ceb-8dc0-4ceaac993007"],
Cell[68610, 1510, 524, 10, 34, "Output", "ExpressionUUID" -> \
"bd347e10-0f7e-4e86-8931-bc7ba970ce66"],
Cell[69137, 1522, 544, 10, 34, "Output", "ExpressionUUID" -> \
"27b92917-6d4c-42f3-bcb4-66a43038bb54"],
Cell[69684, 1534, 539, 10, 34, "Output", "ExpressionUUID" -> \
"99089870-1618-4b16-937d-ae32a5c6bb6a"]
}, Open  ]],
Cell[70238, 1547, 248, 4, 33, "Text", "ExpressionUUID" -> \
"01115663-c1f5-412a-bb73-a4e7d85ebfcf"]
}
]
*)

